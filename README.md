# üß† ML Model Serving

## üöÄ –û–ø–∏—Å–∞–Ω–∏–µ

REST API –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –º–æ–¥–µ–ª–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –Ω–∞ **FastAPI**.  
–ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –≤ –≤–∏–¥–µ —Ü–≤–µ—Ç–Ω–æ–π –º–∞—Å–∫–∏.

![–ü—Ä–∏–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ](docs/origin.jpg)
![–†–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∏](docs/mask.jpg)

## ü§ñ –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å

- **–ú–æ–¥–µ–ª—å**: `UperNetForSemanticSegmentation` (Hugging Face)
- **–ë—ç–∫–±–æ–Ω**: `ConvNeXt-tiny`
- **–î–∞—Ç–∞—Å–µ—Ç**: –æ–±—É—á–µ–Ω–∞ –Ω–∞ ADE20K (150 –∫–ª–∞—Å—Å–æ–≤)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: —Å–≤–µ—Ä—Ç–æ—á–Ω–∞—è —Å–µ—Ç—å –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ —Å—Ü–µ–Ω–∏—á–µ—Å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

üîó [https://huggingface.co/openmmlab/upernet-convnext-tiny](https://huggingface.co/openmmlab/upernet-convnext-tiny)

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- FastAPI
- PyTorch
- Transformers (Hugging Face)
- PIL / NumPy
- FastAPI Docs (Swagger UI)

## üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
poetry install
```

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

```bash
make dev
```

API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:  
üëâ http://localhost:8000  
Swagger UI: http://localhost:8000/docs

## üåê API Endpoints

| –ú–µ—Ç–æ–¥ | –ü—É—Ç—å        | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|-------------|----------|
| GET   | `/health`   | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å–∞ |
| POST  | `/segment`  | –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –º–∞—Å–∫—É —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ |

## üñº –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```bash
curl -X POST "http://localhost:8000/segment" \
     -H "accept: image/png" \
     -H "Content-Type: multipart/form-data" \
     -F "file=@your_image.jpg" \
     --output segmented_mask.png
```
